<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">
	  
	<th:block layout:fragment="customTitle">
		<title th:text="${title}"></title> 
	</th:block>
	
	<th:block layout:fragment="customContent">
	<link rel="stylesheet" type="text/css" th:href="@{/css/code.css}">
	
	
	
		
				

<!------------------- 코딩 소스 들어갈곳 Start ---------------------------------------------->
	
	<!-- 메뉴설명 -->
	<div class="app-main__inner">
	<div class="app-page-title">
        <div class="page-title-wrapper">
            <div class="page-title-heading">
                <div class="page-title-icon">
                    <i class="pe-7s-config icon-gradient bg-premium-dark">
                    </i>
                </div>
                <div>고용형태코드관리
                    <div class="page-title-subheading">고용형태관련 코드를 관리합니다.
                    </div>
                </div>
            </div>   
         </div>
    </div> 
    
    	<!-- 코드등록버튼 -->
		<div class="code-btn">
			<ul>
				<li class="btn-group nav-item ">
		                  <a href="/addEmpCode" class="nav-link">
		                       <i class="nav-link-icon fa fa-edit"></i>신규코드등록
		                  </a>
		         </li>		
			</ul>
   		</div>
    
    	<!-- 검색기능 -->
    	  
    	  <form action="/searchEmpCode" method="post">
    	  	<div class="input-group col-md-4 p-l-none p-r-none p-b-xs">
						<select id = "sk" name="sk" class="form-control select-form" >
							<option value="" selected="selected" disabled="disabled">:: 카테고리 ::</option>
							<option value="emp_code">고용코드</option>
							<option value="emp_type">고용형태</option>
							<option value="emp_salary_type">사원구분</option>
							<option value="emp_attribution">귀속구분</option>
							<option value="reg_staff_name">등록자</option>
						</select>
						<input type="text" name="sv" class="form-control select-form">	
							<button type="submit" id="searchBtn" class="mb-6 mr-2 btn btn-primary"><i class="pe-7s-search">검색</i></button>
							</div>
					</form>	
    
    	
    
		<!-- 리스트 테이블 -->
		<div class="col-md-12 m-2">
			<div class="main-card mb-10 card table-padding">
				<table class="table table-hover">
				 	<thead>
				 		<tr>				 			
				 			<th>고용코드</th>
				 			<th>고용형태</th>
				 			<th>사원구분</th>
				 			<th>귀속구분</th>
				 			<th>시작일</th>
				 			<th>등록자</th>
				 			<th>등록일</th>
				 			<th>수정</th>
				 			<th>삭제</th>
				 		</tr>
				 	</thead>
				 	<tbody>
				 		<tr th:each="l : ${empCodeList}">
				 			<td th:text="${l.empCode}"></td>
				 			<td th:text="${l.empType}"></td>					 						
				 			<td th:text="${l.empSalaryType}"></td>
				 			<td th:text="${l.empAttri}"></td>
				 			<td th:text="${l.empStartDate}"></td>
				 			<td th:text="${l.empStaffName}"></td>
				 			<td th:text="${l.empRegDate}"></td>
				 			<td>
				 				<a th:href="@{/updateEmpCode(empCode=${l.empCode})}">
				 					<button class="btn btn-primary">수정</button>	
				 				</a>
				 			</td>
							<td>
								<button type="button" class="btn btn-primary deleteEmpBtn" data-toggle="modal" data-target="#myModal">삭제</button>
									                     	
							</td>
				 		</tr>
				 	</tbody>
				</table>
			</div>
		</div>
</div>

<!-- Modal -->
                  <div class="modal fade" id="myModal">
					  <div class="modal-dialog">
					    <div class="modal-content">
					      <div class="modal-header">
					        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
					        <h4 class="modal-title">알림</h4>
					      </div>
					      <div class="modal-body">
                           		   <p>정말로 삭제하시겠습니까?</p>
                          </div>
			      <div class="modal-footer">
			        <button type="button" class="btn btn-default" data-dismiss="modal">닫기</button>
			        <button type="button" class="btn btn-primary" id="deleteBtn">
			       		 <!-- <a th:href="@{/deleteDmpCode(empCode=${l.empCode})}">예</a> -->
			       		 예			       		
			        </button>
			      </div>
			    </div>
			  </div>
			</div>

      


<!------------------- 코딩 소스 들어갈곳 End ------------------------------------------------>
	
	</th:block>
	
	<th:block layout:fragment="customJsScript">
	<script>
	
			$(function(){
				$('#deleteBtn').click(function(){
					
				var checkBtn = $('.deleteEmpBtn');


                // checkBtn.parent() : checkBtn의 부모는 <td>이다.
                // checkBtn.parent().parent() : <td>의 부모이므로 <tr>이다.
                var tr = checkBtn.parent().parent();
                var td = tr.children();
                var empCode = td.eq(0).text(); //근무형태코드
               
                //텍스트형식으로 empCode에 담아서 주소로 보내기
                location.href="/deleteEmpCode?empCode="+empCode;
				})
                

		     });
			
			$(function(){
				
				/* 카테고리 미선택시, 검색어 미입력시 알람  */
					$('#searchBtn').click(function(){
						var sk = $('#sk option:selected').val();
						var sv = $('input[name="sv"]').val();
						if(sk == ''){
							alert('카테고리를 선택하세요');
							return false;
						}
						if(sv == ''){
							alert('검색어를 입력하세요')
							return false;
						}
					});
				});
			
			
			
	</script>
	</th:block>
	
    
</html>
