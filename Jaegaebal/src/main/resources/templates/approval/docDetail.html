<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">
	  
	<th:block layout:fragment="customTitle">
		<title th:text="${title}"></title> 
	</th:block>
	

	
	<th:block layout:fragment="customCss">
		<!-- include summernote css/js -->
		<link rel="stylesheet" href="summernote/summernote-lite.css">
		
		<!-- upmu.css  -->
		<link rel="stylesheet" type="text/css" th:href="@{/css/upmu.css}">	
		
	</th:block>
	
	
	<th:block layout:fragment="customContent">

<!------------------- 코딩 소스 들어갈곳 Start ---------------------------------------------->		

 <form id="appDecide" action="/appDecide" method="post">
  	<div class="col-md-10">
		<div class="app-page-title">
			<div class="page-title-wrapper">
				<div class="page-title-heading">
				    <div class="page-title-icon">
				        <i class="pe-7s-eyedropper icon-gradient bg-happy-itmeo">
				        </i>
				    </div>
				    <div>
				    	<h2>상세보기</h2>
				       <div class="page-title-subheading"></div>
				    </div>
				</div>
			</div>
		</div>                
		
	<div class="col-md-12">
		<div class="main-card mb-3 card"> 
			<div class="card-body">
				<div class="table-body">
					<table id="appLine" class="mb-2 table table-bordered">
						<tr>
						<th:block th:each="l : ${getAppLine}">							
                        	<td class='text-center app-StaffLevel' th:text="${l.appLevelName}"></td>
                        	<td class='appLine-form'>
                       			<table>
                        			<tr>
                        				<td class='text-center' th:text="${l.appJojicName}"></td>
                        			</tr>
                        			<tr>
                        				<td class='text-center' th:text="${l.appStaffName}"></td>
                        			</tr>                     				
                        			<tr>
                        				<td class='text-center app-sign' th:text="${l.appStateName}" th:title="${l.appStaffComent}"></td>
                        			</tr>
                        			<tr th:if="${l.appStaffNum eq session.SSTAFFNUM}">
                        				<td>
                        					<button class='btn-transition btn  btn-outline-danger appbtn-center' type="button" data-toggle="modal" data-target="#decideModdal">결재하기</button>
                        				</td>
                        			</tr>
                        		</table>
                        	</td>
						</th:block>		
                        </tr>
                 	</table>	
				</div>	
				<th:block th:each="d : ${docDetail}">
				<input type="hidden" th:value="${d.docCode}" name="docCode">
				<div class="position-relative form-group index-front">
		          	<div class="position-relative form-group document-form">
		             		<label for="docType" >문서양식</label>
		             		<input type="text" class="form-control" th:value="${d.docTypeName}"  readonly="readonly">
		              </div>
		              <div class="position-relative form-group deadline-form"><label for="deadline" class="" >마감요청일</label>
		              	<input type="text" class="form-control"  th:value="${d.deadline}" readonly="readonly">   
		              </div>
		        </div>       
		             <div class="position-relative form-group"><label for="docTitle" class="">제목</label>
		            		<input id="docTitle" type="text" class="form-control"  th:value="${d.docTitle}" readonly="readonly" >
		             </div>                  
					 <textarea id="summernote" th:text="${d.docContents}" readonly="readonly"></textarea>
		             <div class="position-relative form-group"><label for="exampleText" class="">코멘트</label>
		             	<textarea  id="docComent" class="form-control" th:text="${d.docComent}" readonly="readonly"></textarea>
		             </div>
		             <div class="position-relative form-group" ><label for="docFile" class="">첨부파일</label>
		              	<input  id="docFile" type="file" class="form-control-file" th:text="${d.docFile}">
		             </div>
		             <div class="position-relative form-group"> <label for="appSecurity" class="">보안처리</label>
		               	<input type="checkbox" th:checked="${d.appSecurity eq '보안'}">
		             </div>
		           </th:block> 
  
     			</div>
     		</div>
     	</div>
     </div>
     	
<!------------------- decideModdal 시작   ------------------------>     
         <div  class="modal fade" id="decideModdal">
            <div class="modal-dialog modal-lg-5" style="width: auto; ">
              <div class="modal-content">
                 <div class="modal-header">
                    <h4 class="modal-title" id="myModalLabel">결재하기</h4>
                 </div>
                 <div class="modal-body">
                    <div class="main-card col-lg-12 card modal-inform">
	                    	<div class="card-body">                    	
	                            <h5>결재유형선택하기</h5>
	                            <input type="hidden" th:value="${session.SSTAFFNUM}" name="appStaffNum">
	                            <select id="appState" class="form-control" name="appStateCode">                          
	                            	<option value="" selected="selected" disabled="disabled">::결재하기::</option>
	                            	<option th:value="ac-02">반려</option>
	                            	<option th:value="ac-03">합의</option>
	                            </select>
	                    	</div>        
	                    	<div class="card-body">
	                            <h5>결재자 코멘트</h5>
	                            <textarea name="appStaffComent" class="form-control"></textarea>
	                    	</div>        
	                   		<div class="modal-footer">
	                       		<button type="button" class="btn btn-outline-primary" data-dismiss="modal">취소</button>
	                       		<button type="button" id="successBtn" class="btn btn-primary" data-dismiss="modal">결재완료</button>
	                     	</div>                   	
               		</div>
            	</div>            
         	</div>
     	 </div>
     	</div>
    </form>

<!------------------- 코딩 소스 들어갈곳 End ------------------------------------------------>




	</th:block>

	<!-- 사용자 지정 script -->
	<th:block layout:fragment="customJsScript">		
		 <script src="/summernote/summernote-lite.js"></script>
      <script src="/summernote/lang/summernote-ko-KR.js"></script>
	

		
		<!-- summernote 관련-->
		<script type="text/javascript">
		$(document).ready(function() {
			$('#summernote').summernote({
				  height: 300,                 // 에디터 높이
				  minHeight: null,             // 최소 높이
				  maxHeight: null,             // 최대 높이
				  focus: true,                  // 에디터 로딩후 포커스를 맞출지 여부
				  lang: "ko-KR",					// 한글 설정
				
			          
				});
				
				//결재란 크기 조정 
	            if($('#appLine').find('.app-StaffLevel').length == 4){
	    	 		$('.table-body').removeClass().addClass('table-body four-td');		
	            }
	            else if($('#appLine').find('.app-StaffLevel').length == 3){	
	            	$('.table-body').removeClass().addClass('table-body three-td');		            	
	            }else if($('#appLine').find('.app-StaffLevel').length == 2){
	            	$('.table-body').removeClass().addClass('table-body two-td');	
	            }else if($('#appLine').find('.app-StaffLevel').length == 1){
	            	$('.table-body').removeClass().addClass('table-body one-td');	
	            }else{
	            	$('.table-body').removeClass().addClass('table-body');
	            }
				
				//결재완료 버튼 클릭 시 
				$('#successBtn').click(function(){
					var appState = $('#appState option:selected').val();
					console.log(appState + "<--appState");
					if(appState == ''){
						alert('결재유형을 선택하세요');
						return false;
					}
					else{
						$('#appDecide').submit();						
					}
				});
				
			});				
		</script>
		
	
	</th:block>

</html>
