<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	  layout:decorate="layout/default">
	  
	<th:block layout:fragment="customTitle">
		<title th:text="${title}"></title> 
	</th:block>
	<th:block layout:fragment="customCss">
		<!-- upmu.css  -->
		<link rel="stylesheet" type="text/css" th:href="@{/css/upmu.css}">
	</th:block>
	
    
	<th:block layout:fragment="customContent">
<!------------------- 코딩 소스 들어갈곳 Start ---------------------------------------------->
 		<div class="col-md-10">
			<div class="app-page-title">
				<div class="page-title-wrapper">
					<div class="page-title-heading">
					    <div class="page-title-icon">
					        <i class="pe-7s-note2 icon-gradient bg-happy-itmeo "></i>
					    </div>
					    <div>
					    	<h3>개인결재함</h3>					    		
					       	<div class="page-title-subheading">
					       	</div>
					    </div>
					</div>
				</div>
			</div>
             <div class="main-card mb-10 card">
                  <div class="card-body">  
                  	<h4><i class="pe-7s-note2"></i> 상신함 </h4><br>
                  	<form action="/myAppList" method="post">
						<select id = "sk" name="sk" class="form-control select-form" >
							<option value="" selected="selected" disabled="disabled">::검색조건::</option>
							<option value="t.doc_type">문서유형</option>
							<option value="doc_title">제목</option>
							<option value="a.app_state">결재상태</option>
						</select>
						<input type="text" name="sv" class="form-control select-form">	
							<button type="submit" id="seachBtn" class="mb-2 mr-2 btn btn-primary"><i class="pe-7s-search">    검색</i></button>
					</form>
					<br>
					<table class="mb-0 table table-hover ">
                    	<thead>
	                         <tr>
	                             <th class="text-center">문서코드</th>
	                             <th class="text-center">문서유형</th>
	                             <th class="text-center">제목</th>
	                             <th class="text-center">첨부파일</th>
	                             <th class="text-center" >보안</th>
	                             <th class="text-center">마감요청일</th>
	                             <th class="text-center">기안날짜</th>
	                             <th class="text-center">결재상태</th>
	                             <th class="text-center">회수하기</th>
	                         </tr>
	                    </thead>
                        <tbody id="myAppList">                       
	                        <tr th:each="l : ${myAppList}" th:if="${l.writerNum eq session.SSTAFFNUM}">
	                            <td th:text="${l.docCode}" th:value="${l.docCode}" id="docCode" class='text-center'></td>
	                            <td th:text="${l.docTypeName}" id="docTypeName" class='text-center'></td>
	                            <td><a th:text="${l.docTitle}" id="docTitle" class='text-center' th:href="@{/docDetail(docCode=${l.docCode})}"></a></td>
	                            <td th:text="${l.docFile}"  id="docFile" class='text-center'></td>
	                            <td th:text="${l.appSecurity}" id="security" class='text-center'></td>
	                            <td th:text="${l.deadline}" id="deadline" class='text-center'></td>
	                            <td th:text="${l.writeDate}" id="writeDate" class='text-center'></td>
	                            <td th:text="${l.appStateName}" th:value="${l.appStateName}" id="appStateName" class='text-center'></td>	                        	
	                            <td class='text-center'><button type="button" class="mb-2 mr-2 btn-transition btn btn-outline-primary retrievalBtn" >회수하기</button></td>	                        	
	                        </tr>
	                       
                        </tbody>
                    </table>
                  </div>
             </div> 
       </div>          







<!------------------- 코딩 소스 들어갈곳 End ------------------------------------------------>

	</th:block>
    <th:block layout:fragment="customJsScript">     
	
	<script>
		$(function(){
			
		/* 검색버튼 클릭 시 검색조건과 검색값 꼭 입력하도록 하기  */
			$('#seachBtn').click(function(){
				var sk = $('#sk option:selected').val();
				var sv = $('input[name="sv"]').val();
				if(sk == ''){
					alert('검색조건을 선택하세요');
					return false;
				}
				if(sv == ''){
					alert('검색어를 입력하세요')
					return false;
				}
			});
			
		/* 회수 가능 여부   */
	 		$('.retrievalBtn').click(function(){
				
				var retrievalBtn = $(this);
				var tr = retrievalBtn.parent().parent();
			    var td = tr.children();
				var appStateName = td.eq(7).text();
				console.log(appStateName +"<--appStateName");
				if(appStateName == "미열람" ){
					alert('반려/회수함으로 이동되었습니다.');
					return false;
				}else{
					alert('미열람 시에만 회수하실 수 있습니다.');
				}
								
	  		});		
		});
	</script>	
    </th:block>
</html>