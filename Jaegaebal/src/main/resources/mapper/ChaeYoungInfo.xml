<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.jaegaebal.mapper.ChaeYoungMapper">
	<resultMap type="ChaeYoungInfo" id="ChaeYoungInfoResultMap">
		
	<!-- 공통사항 -->
	<result column="app_num_code"				property="appNumCode"/>
	<result column="job_number"					property="jobNumber"/>
	<result column="app_email"					property="appEmail"/>
	<result column="reg_date"					property="regDate"/>
	
	<!-- 기본인적사항 -->
	<result column="basic_info_code"			property="basicInfoCode"/>
	<result column="staff_eng_name"				property="staffEngName"/>
	<result column="human_num"					property="humanNum"/>
	<result column="staff_gender"				property="staffGender"/>
	<result column="staff_nationality"			property="staffNationality"/>
	<result column="staff_country"				property="staffCountry"/>
	<result column="staff_phone"				property="staffPhone"/>
	<result column="staff_email"				property="staffEmail"/>
	<result column="staff_marriged"				property="staffMarriged"/>
	<result column="staff_addr"					property="staffAddr"/>
	
	<!-- 경력사항 -->
<!-- 	<result column="career_info_code"			property="careerInfoCode"/>
	<result column="company_name"				property="companyName"/>
	<result column="company_access"				property="companyAccess"/>
	<result column="company_position_from_out"	property="companyPositionFromOut"/>
	<result column="company_work_form_out"		property="companyWorkFormOut"/>
	<result column="company_in_date_from_out"	property="companyInDateFromOut"/>
	<result column="company_out_date_from_out"	property="companyOutDateFromOut"/>
	<result column="company_out_reason"			property="companyOutReason"/> -->
	
	<!-- 자격증사항 -->
	<result column="certificate_info_code"		property="certificateInfoCode"/>
	<result column="certificate_name"			property="certificateName"/>
	<result column="issuing_agency"				property="issuingAgency"/>
	<result column="certificate_num"			property="certificateNum"/>
	<result column="get_date"					property="getDate"/>
	<result column="finished_date"				property="finishedDate"/>
	
	<!-- 학력사항 -->
	<result column="education_info_code"		property="educationInfoCode"/>
	<result column="school_name"				property="schoolName"/>
	<result column="hakryuck_status"			property="hakryuckStatus"/>
	<result column="major_name"					property="majorName"/>
	<result column="minor_name"					property="minorName"/>
	<result column="entrance_date"				property="entranceDate"/>
	<result column="graduat_date"				property="graduatDate"/>
	<result column="degree"						property="degree"/>
	
	<!-- 병역사항 -->
	<result column="military_info_code"			property="militaryInfoCode"/>
	<result column="military_classidx"			property="militaryClassidx"/>
	<result column="military_service_type"		property="militaryServiceType"/>
	<result column="military_state"				property="militaryState"/>
	<result column="military_in_day"			property="militaryInDay"/>
	<result column="military_out_day"			property="militaryOutDay"/>
	<result column="military_level"				property="militaryLevel"/>
	<result column="military_info_notes"		property="militaryInfoNotes"/>

	</resultMap>
	<resultMap type="ChaeYoungCareerInfo" id="ChaeYoungCareerInfoResultMap" >
		<!-- 공통사항 -->
		<result column="app_num_code"				property="appNumCode"/>
		<result column="job_number"					property="jobNumber"/>
		<result column="app_email"					property="appEmail"/>
		<result column="reg_date"					property="regDate"/>
		<!-- 경력사항 -->
		<result column="career_info_code"			property="careerInfoCode"/>
		<result column="company_name"				property="companyName"/>
		<result column="company_access"				property="companyAccess"/>
		<result column="company_position_from_out"	property="companyPositionFromOut"/>
		<result column="company_work_form_out"		property="companyWorkFormOut"/>
		<result column="company_in_date_from_out"	property="companyInDateFromOut"/>
		<result column="company_out_date_from_out"	property="companyOutDateFromOut"/>
		<result column="company_out_reason"			property="companyOutReason"/>
	</resultMap>
	<!-- 기본인적사항 -->
	<insert id="addBasicInfo" parameterType="ChaeYoungInfo">
		<selectKey resultType="String" keyProperty="basicInfoCode" order="BEFORE">
			SELECT 
				CONCAT('basic',LPAD(max(cast(SUBSTRING(basic_info_code,6)AS DECIMAL))+1,5,0))
			FROM
				cy_applicant_basic_info
		</selectKey>
		INSERT INTO cy_applicant_basic_info
			(basic_info_code, job_number, app_email, app_num_code, staff_eng_name, human_num, staff_gender, staff_nationality, staff_country, staff_phone, staff_email, staff_marriged, staff_addr, reg_date)
		VALUES (
			#{basicInfoCode},
			#{jobNumber},
			#{appEmail},
			#{appNumCode},		
			<if test="staffEngName != null and staffEngName neq ''.toString()">
				#{staffEngName},
			</if>
			<if test="humanNum != null and humanNum neq ''.toString()">
				#{humanNum},
			</if>
			<if test="staffGender != null and staffGender neq ''.toString()">
				#{staffGender},
			</if>
			<if test="staffNationality != null and staffNationality neq ''.toString()">
				#{staffNationality},
			</if>
			<if test="staffCountry != null and staffCountry neq ''.toString()">
				#{staffCountry},
			</if>
			<if test="staffCountry == null || staffCountry eq ''.toString()">
				'대한민국',
			</if>
			<if test="staffPhone != null and staffPhone neq ''.toString()">
				#{staffPhone},
			</if>
			<if test="staffEmail != null and staffEmail neq ''.toString()">
				#{staffEmail},
			</if>
			<if test="staffMarriged != null and staffMarriged neq ''.toString()">
				#{staffMarriged},
			</if>
			<if test="staffAddr != null and staffAddr neq ''.toString()">
				#{staffAddr},
			</if>
			NOW())
	</insert>
	
	<!-- 경력사항 -->
	<insert id="addCareerInfo" parameterType="ChaeYoungCareerInfo">
		<selectKey resultType="String" keyProperty="careerInfoCode" order="BEFORE">
			SELECT 
				CONCAT('career',LPAD(max(cast(SUBSTRING(career_info_code,7)AS DECIMAL))+1,5,0))
			FROM
				cy_applicant_career_info
		</selectKey>
		INSERT INTO cy_applicant_career_info
			(career_info_code, job_number, app_email, app_num_code, company_name, company_access, company_position_from_out, company_work_form_out, company_in_date_from_out, company_out_date_from_out, company_out_reason, reg_date)
		VALUES (
			#{careerInfoCode},
			#{jobNumber},
			#{appEmail},
			#{appNumCode},		
			<if test="companyName != null and companyName neq ''.toString()">
				#{companyName},
			</if>
			<if test="companyAccess != null and companyAccess neq ''.toString()">
				#{companyAccess},
			</if>
			<if test="companyPositionFromOut != null and companyPositionFromOut neq ''.toString()">
				#{companyPositionFromOut},
			</if>
			<if test="companyWorkFormOut != null and companyWorkFormOut neq ''.toString()">
				#{companyWorkFormOut},
			</if>
			<if test="companyInDateFromOut != null and companyInDateFromOut neq ''.toString()">
				#{companyInDateFromOut},
			</if>
			<if test="companyOutDateFromOut != null and companyOutDateFromOut neq ''.toString()">
				#{companyOutDateFromOut},
			</if>
			<if test="companyOutReason != null and companyOutReason neq ''.toString()">
				#{companyOutReason},
			</if>
			NOW())
	</insert>
	
	<!-- 자격증사항 -->
	<insert id="addCertificateInfo" parameterType="ChaeYoungInfo">
	

	</insert>
	
	<!-- 학력사항 -->
	<insert id="addEducationInfo" parameterType="ChaeYoungInfo">
	

	</insert>
	
	<!-- 병역사항 -->
	<insert id="addMilitaryInfo" parameterType="ChaeYoungInfo">
		<selectKey resultType="String" keyProperty="militaryInfoCode" order="BEFORE">		
			SELECT 
				CONCAT('mili',LPAD(max(cast(SUBSTRING(military_info_code,5)AS DECIMAL))+1,5,0))
			FROM
				cy_applicant_military_info
		</selectKey>
		INSERT INTO cy_applicant_military_info
			(military_info_code, job_number, app_email, app_num_code,
			 military_classidx, military_service_type, military_state, military_in_day, military_out_day, military_level, military_info_notes, reg_date)
		VALUES (
			#{militaryInfoCode},
			#{jobNumber},
			#{appEmail},
			#{appNumCode},	
			#{militaryClassidx},
			<choose>
				<when test="militaryClassidx != '여성' and militaryClassidx != '면제'">				
									
					#{militaryServiceType},
					#{militaryState},
					#{militaryInDay},				
					#{militaryOutDay},									
					#{militaryLevel},							
					'',
				</when>
				<otherwise>					
					'',
					'',
					'0000-00-00',
					'0000-00-00',
					'',
					<if test="militaryInfoNotes != null and militaryInfoNotes neq ''.toString()">
					#{militaryInfoNotes},
					</if>
					<if test="militaryInfoNotes == null or militaryInfoNotes eq ''.toString()">
					'',
					</if>

				</otherwise>
			</choose>
					NOW())

	</insert>

</mapper>